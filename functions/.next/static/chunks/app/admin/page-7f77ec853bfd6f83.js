(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{344:(e,t,s)=>{"use strict";s.d(t,{CA:()=>d,_h:()=>a,y4:()=>n});var l=s(6203),r=s(1304);let a=async(e,t)=>{try{if(!r.j2)throw Error("인증 인스턴스가 초기화되지 않았습니다");let s=await (0,l.x9)(r.j2,e,t);return{success:!0,user:s.user}}catch(e){return{success:!1,error:e.message}}},n=async()=>{try{if(!r.j2)throw Error("인증 인스턴스가 초기화되지 않았습니다");return await (0,l.CI)(r.j2),{success:!0}}catch(e){return{success:!1,error:e.message}}},d=e=>r.j2?(0,l.hg)(r.j2,e):()=>{}},639:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var l=s(5155),r=s(2115),a=s(5695),n=s(650),d=s(344),i=s(5317),c=s(1304);function o(){let[e,t]=(0,r.useState)({totalVideos:0,videosPerLevel:{},videosPerQuarter:{},lessonVideos:0,libraryVideos:0,recentVideos:[]}),[s,a]=(0,r.useState)(!0),[n,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{!async function(){try{a(!0),d(null);let e=(0,i.rJ)(c.db,"videos"),s=(await (0,i.d_)(e)).data().count,l=(0,i.P)(e,(0,i._M)("type","==","lesson")),r=(await (0,i.d_)(l)).data().count,n=(0,i.P)(e,(0,i._M)("type","==","library")),o=(await (0,i.d_)(n)).data().count,x={};for(let t=1;t<=6;t++){let s=(0,i.P)(e,(0,i._M)("levelId","==",t.toString())),l=await (0,i.d_)(s);x[t]=l.data().count}let u={};for(let t=1;t<=4;t++){let s=(0,i.P)(e,(0,i._M)("quarterId","==","q".concat(t))),l=await (0,i.d_)(s);u[t]=l.data().count}let h=(0,i.P)(e,(0,i.My)("createdAt","desc"),(0,i.AB)(5)),m=await (0,i.GG)(h),p=[];m.forEach(e=>{var t,s;p.push({id:e.id,...e.data(),createdAt:(null==(s=e.data().createdAt)||null==(t=s.toDate)?void 0:t.call(s))||new Date})}),t({totalVideos:s,videosPerLevel:x,videosPerQuarter:u,lessonVideos:r,libraryVideos:o,recentVideos:p}),a(!1)}catch(e){console.error("대시보드 통계 로딩 오류:",e),d("통계 데이터를 불러오는 중 오류가 발생했습니다."),a(!1)}}()},[]);let o=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"});return s?(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,l.jsxs)("div",{className:"flex justify-center items-center h-40",children:[(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)("p",{className:"ml-2",children:"통계를 불러오는 중..."})]})}):n?(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,l.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-4",children:n})}):(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"관리자 대시보드"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"bg-purple-100 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"text-purple-800 text-lg font-semibold",children:"전체 비디오"}),(0,l.jsx)("p",{className:"text-purple-900 text-3xl font-bold",children:e.totalVideos})]}),(0,l.jsxs)("div",{className:"bg-blue-100 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"text-blue-800 text-lg font-semibold",children:"주차별 수업"}),(0,l.jsx)("p",{className:"text-blue-900 text-3xl font-bold",children:e.lessonVideos})]}),(0,l.jsxs)("div",{className:"bg-green-100 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"text-green-800 text-lg font-semibold",children:"영상 자료실"}),(0,l.jsx)("p",{className:"text-green-900 text-3xl font-bold",children:e.libraryVideos})]}),(0,l.jsxs)("div",{className:"bg-yellow-100 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"text-yellow-800 text-lg font-semibold",children:"최근 추가"}),(0,l.jsx)("p",{className:"text-yellow-900 text-3xl font-bold",children:e.recentVideos.length})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-700 mb-3",children:"레벨별 비디오"}),(0,l.jsx)("div",{className:"space-y-2",children:Object.entries(e.videosPerLevel).map(t=>{let[s,r]=t;return(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"w-1/4",children:["레벨 ",s]}),(0,l.jsxs)("div",{className:"w-3/4 flex items-center",children:[(0,l.jsx)("div",{className:"bg-purple-500 h-4 rounded",style:{width:"".concat(Math.max(r/e.totalVideos*100,3),"%")}}),(0,l.jsxs)("span",{className:"ml-2",children:[r,"개"]})]})]},s)})})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-700 mb-3",children:"분기별 비디오"}),(0,l.jsx)("div",{className:"space-y-2",children:Object.entries(e.videosPerQuarter).map(t=>{let[s,r]=t;return(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("div",{className:"w-1/4",children:[s,"분기"]}),(0,l.jsxs)("div",{className:"w-3/4 flex items-center",children:[(0,l.jsx)("div",{className:"bg-blue-500 h-4 rounded",style:{width:"".concat(Math.max(r/e.totalVideos*100,3),"%")}}),(0,l.jsxs)("span",{className:"ml-2",children:[r,"개"]})]})]},s)})})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-700 mb-3",children:"최근 추가된 비디오"}),e.recentVideos.length>0?(0,l.jsxs)("table",{className:"admin-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"제목"}),(0,l.jsx)("th",{children:"타입"}),(0,l.jsx)("th",{children:"레벨"}),(0,l.jsx)("th",{children:"추가일"})]})}),(0,l.jsx)("tbody",{children:e.recentVideos.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:e.title}),(0,l.jsx)("td",{children:"lesson"===e.type?"주차별 수업":"영상 자료실"}),(0,l.jsxs)("td",{children:["레벨 ",e.levelId]}),(0,l.jsx)("td",{children:o(e.createdAt)})]},e.id))})]}):(0,l.jsx)("p",{className:"text-gray-500 text-center py-4",children:"최근 추가된 비디오가 없습니다."})]})]})}var x=s(2743);function u(){let[e,t]=(0,r.useState)({title:"",description:"",videoUrl:"",thumbnail:"",levelId:"1",quarterId:"q1",monthId:"",weekId:"",type:"lesson"}),[s,a]=(0,r.useState)(""),[n,d]=(0,r.useState)({text:"",type:""}),[i,c]=(0,r.useState)(!1),o=e=>{let{name:s,value:l}=e.target;t(e=>({...e,[s]:l}))},u=e=>{try{let t=e.replace(/\\/g,"/"),s=t.indexOf("AWSM3");if(-1===s)return"";let l=t.substring(s+6),r=l.lastIndexOf("/"),a=l.substring(r+1),n=a.substring(0,a.lastIndexOf(".")),d=l.substring(0,r);return"https://d3asw5knevel36.cloudfront.net/videos/".concat(d,"/hls/").concat(n,"/").concat(n,".m3u8")}catch(e){return console.error("경로 변환 오류:",e),""}};(0,r.useEffect)(()=>{"library"===e.type&&t(e=>({...e,monthId:"",weekId:""}))},[e.type]);let h=async s=>{s.preventDefault();try{if(c(!0),!e.title||!e.videoUrl){d({text:"제목과 비디오 URL은 필수 입력항목입니다.",type:"error"}),c(!1);return}if("lesson"===e.type&&(!e.monthId||!e.weekId)){d({text:"주차별 영상에는 월과 주차 정보가 필요합니다.",type:"error"}),c(!1);return}await (0,x.Nj)(e),d({text:"비디오가 성공적으로 추가되었습니다!",type:"success"}),t({title:"",description:"",videoUrl:"",thumbnail:"",levelId:"1",quarterId:"q1",monthId:"",weekId:"",type:"lesson"}),a(""),c(!1)}catch(e){console.error("비디오 추가 오류:",e),d({text:"비디오 추가 중 오류가 발생했습니다.",type:"error"}),c(!1)}};return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"새 비디오 추가"}),n.text&&(0,l.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat("success"===n.type?"bg-green-100 text-green-700":"error"===n.type?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:n.text}),(0,l.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"제목 *"}),(0,l.jsx)("input",{type:"text",name:"title",value:e.title,onChange:o,className:"w-full p-2 border rounded",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),(0,l.jsx)("textarea",{name:"description",value:e.description,onChange:o,className:"w-full p-2 border rounded",rows:"3"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"로컬 비디오 경로"}),(0,l.jsx)("input",{type:"text",value:s,onChange:e=>{let s=e.target.value;if(a(s),s){let e=u(s);t(t=>({...t,videoUrl:e}))}else t(e=>({...e,videoUrl:""}))},className:"w-full p-2 border rounded",placeholder:"C:\\Users\\...\\AWSM3\\레벨1\\1분기\\파일명.mp4"}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"로컬 경로 입력 시 자동으로 CloudFront URL로 변환됩니다."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"비디오 URL (CloudFront HLS .m3u8) *"}),(0,l.jsx)("input",{type:"url",name:"videoUrl",value:e.videoUrl,onChange:o,className:"w-full p-2 border rounded bg-gray-50",placeholder:"https://d3asw5knevel36.cloudfront.net/videos/.../파일명.m3u8",required:!0}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"위 로컬 경로에서 변환된 URL 또는 직접 입력하세요."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"썸네일 URL"}),(0,l.jsx)("input",{type:"url",name:"thumbnail",value:e.thumbnail,onChange:o,className:"w-full p-2 border rounded"})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"비디오 유형"}),(0,l.jsxs)("select",{name:"type",value:e.type,onChange:o,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"lesson",children:"주차별 수업"}),(0,l.jsx)("option",{value:"library",children:"영상 자료실"})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"레벨"}),(0,l.jsxs)("select",{name:"levelId",value:e.levelId,onChange:o,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"1",children:"레벨 1"}),(0,l.jsx)("option",{value:"2",children:"레벨 2"}),(0,l.jsx)("option",{value:"3",children:"레벨 3"}),(0,l.jsx)("option",{value:"4",children:"레벨 4"}),(0,l.jsx)("option",{value:"5",children:"레벨 5"}),(0,l.jsx)("option",{value:"6",children:"레벨 6"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"분기"}),(0,l.jsxs)("select",{name:"quarterId",value:e.quarterId,onChange:o,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"q1",children:"1분기"}),(0,l.jsx)("option",{value:"q2",children:"2분기"}),(0,l.jsx)("option",{value:"q3",children:"3분기"}),(0,l.jsx)("option",{value:"q4",children:"4분기"})]})]})]}),"lesson"===e.type&&(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"월"}),(0,l.jsxs)("select",{name:"monthId",value:e.monthId,onChange:o,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"",children:"선택하세요"}),"q1"===e.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m1",children:"1분기 첫번째 달"}),(0,l.jsx)("option",{value:"m2",children:"1분기 두번째 달"}),(0,l.jsx)("option",{value:"m3",children:"1분기 세번째 달"})]}),"q2"===e.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m4",children:"2분기 첫번째 달"}),(0,l.jsx)("option",{value:"m5",children:"2분기 두번째 달"}),(0,l.jsx)("option",{value:"m6",children:"2분기 세번째 달"})]}),"q3"===e.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m7",children:"3분기 첫번째 달"}),(0,l.jsx)("option",{value:"m8",children:"3분기 두번째 달"}),(0,l.jsx)("option",{value:"m9",children:"3분기 세번째 달"})]}),"q4"===e.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m10",children:"4분기 첫번째 달"}),(0,l.jsx)("option",{value:"m11",children:"4분기 두번째 달"}),(0,l.jsx)("option",{value:"m12",children:"4분기 세번째 달"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"주차"}),(0,l.jsxs)("select",{name:"weekId",value:e.weekId,onChange:o,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"",children:"선택하세요"}),(0,l.jsx)("option",{value:"w1",children:"1주차"}),(0,l.jsx)("option",{value:"w2",children:"2주차"}),(0,l.jsx)("option",{value:"w3",children:"3주차"}),(0,l.jsx)("option",{value:"w4",children:"4주차"})]})]})]})]})]}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)("button",{type:"submit",disabled:i,className:"py-2 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 ".concat(i?"opacity-50 cursor-not-allowed":""),children:i?"처리 중...":"비디오 추가"})})]})]})}function h(){let[e,t]=(0,r.useState)([]),[s,a]=(0,r.useState)({levelId:"1",quarterId:"q1",monthId:"",weekId:"",type:"lesson"}),[n,d]=(0,r.useState)(!1),[i,c]=(0,r.useState)({text:"",type:""}),[o,u]=(0,r.useState)([]),[h,m]=(0,r.useState)(null),[p,j]=(0,r.useState)(""),b=e=>{let{name:t,value:s}=e.target;a(e=>({...e,[t]:s}))},g=async()=>{try{d(!0);let e=[];if("library"===s.type)e=await (0,x.nd)(s.levelId,s.quarterId);else{if(!s.monthId||!s.weekId){c({text:"주차별 비디오를 검색하려면 월과 주차를 모두 선택해주세요.",type:"warning"}),d(!1);return}e=await (0,x.xB)(s.levelId,s.quarterId,s.monthId,s.weekId)}if(p.trim()){let t=p.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t))}t(e),u([]),d(!1),0===e.length?c({text:"검색 결과가 없습니다.",type:"info"}):c({text:"".concat(e.length,"개의 비디오를 찾았습니다."),type:"success"})}catch(e){console.error("비디오 검색 오류:",e),c({text:"비디오 데이터를 불러오는 중 오류가 발생했습니다.",type:"error"}),d(!1)}},v=async e=>{if(confirm("정말로 이 비디오를 삭제하시겠습니까?"))try{d(!0),await (0,x.Ln)(e),t(t=>t.filter(t=>t.id!==e)),u(t=>t.filter(t=>t!==e)),c({text:"비디오가 성공적으로 삭제되었습니다.",type:"success"}),d(!1)}catch(e){console.error("비디오 삭제 오류:",e),c({text:"비디오 삭제 중 오류가 발생했습니다.",type:"error"}),d(!1)}},y=async()=>{if(0===o.length)return void c({text:"삭제할 비디오를 선택해주세요.",type:"warning"});if(confirm("선택한 ".concat(o.length,"개의 비디오를 모두 삭제하시겠습니까?")))try{for(let e of(d(!0),o))await (0,x.Ln)(e);t(e=>e.filter(e=>!o.includes(e.id))),u([]),c({text:"".concat(o.length,"개의 비디오가 성공적으로 삭제되었습니다."),type:"success"}),d(!1)}catch(e){console.error("다중 비디오 삭제 오류:",e),c({text:"비디오 삭제 중 오류가 발생했습니다.",type:"error"}),d(!1)}},N=e=>{u(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},f=e=>{m({...e})},w=e=>{let{name:t,value:s}=e.target;m(e=>({...e,[t]:s}))},I=async()=>{try{d(!0),await (0,x.h5)(h.id,{title:h.title,description:h.description,thumbnail:h.thumbnail,videoUrl:h.videoUrl}),t(e=>e.map(e=>e.id===h.id?h:e)),c({text:"비디오 정보가 성공적으로 업데이트되었습니다.",type:"success"}),m(null),d(!1)}catch(e){console.error("비디오 업데이트 오류:",e),c({text:"비디오 정보 업데이트 중 오류가 발생했습니다.",type:"error"}),d(!1)}},k=()=>{m(null)};return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"비디오 관리"}),i.text&&(0,l.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat("success"===i.type?"bg-green-100 text-green-700":"error"===i.type?"bg-red-100 text-red-700":"info"===i.type?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"),children:i.text}),(0,l.jsxs)("div",{className:"mb-6 bg-gray-50 p-4 rounded-lg",children:[(0,l.jsx)("h3",{className:"text-gray-700 font-medium mb-3",children:"비디오 검색"}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"제목/설명 검색"}),(0,l.jsx)("input",{type:"text",value:p,onChange:e=>{j(e.target.value)},placeholder:"검색어 입력...",className:"w-full p-2 border rounded"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"비디오 유형"}),(0,l.jsxs)("select",{name:"type",value:s.type,onChange:b,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"lesson",children:"주차별 수업"}),(0,l.jsx)("option",{value:"library",children:"영상 자료실"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"레벨"}),(0,l.jsxs)("select",{name:"levelId",value:s.levelId,onChange:b,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"1",children:"레벨 1"}),(0,l.jsx)("option",{value:"2",children:"레벨 2"}),(0,l.jsx)("option",{value:"3",children:"레벨 3"}),(0,l.jsx)("option",{value:"4",children:"레벨 4"}),(0,l.jsx)("option",{value:"5",children:"레벨 5"}),(0,l.jsx)("option",{value:"6",children:"레벨 6"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"분기"}),(0,l.jsxs)("select",{name:"quarterId",value:s.quarterId,onChange:b,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"q1",children:"1분기"}),(0,l.jsx)("option",{value:"q2",children:"2분기"}),(0,l.jsx)("option",{value:"q3",children:"3분기"}),(0,l.jsx)("option",{value:"q4",children:"4분기"})]})]}),"lesson"===s.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"월"}),(0,l.jsxs)("select",{name:"monthId",value:s.monthId,onChange:b,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"",children:"선택하세요"}),"q1"===s.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m1",children:"1분기 첫번째 달"}),(0,l.jsx)("option",{value:"m2",children:"1분기 두번째 달"}),(0,l.jsx)("option",{value:"m3",children:"1분기 세번째 달"})]}),"q2"===s.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m4",children:"2분기 첫번째 달"}),(0,l.jsx)("option",{value:"m5",children:"2분기 두번째 달"}),(0,l.jsx)("option",{value:"m6",children:"2분기 세번째 달"})]}),"q3"===s.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m7",children:"3분기 첫번째 달"}),(0,l.jsx)("option",{value:"m8",children:"3분기 두번째 달"}),(0,l.jsx)("option",{value:"m9",children:"3분기 세번째 달"})]}),"q4"===s.quarterId&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("option",{value:"m10",children:"4분기 첫번째 달"}),(0,l.jsx)("option",{value:"m11",children:"4분기 두번째 달"}),(0,l.jsx)("option",{value:"m12",children:"4분기 세번째 달"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"주차"}),(0,l.jsxs)("select",{name:"weekId",value:s.weekId,onChange:b,className:"w-full p-2 border rounded",children:[(0,l.jsx)("option",{value:"",children:"선택하세요"}),(0,l.jsx)("option",{value:"w1",children:"1주차"}),(0,l.jsx)("option",{value:"w2",children:"2주차"}),(0,l.jsx)("option",{value:"w3",children:"3주차"}),(0,l.jsx)("option",{value:"w4",children:"4주차"})]})]})]})]}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("button",{onClick:g,disabled:n,className:"py-2 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 ".concat(n?"opacity-50 cursor-not-allowed":""),children:n?"검색 중...":"비디오 검색"})})]}),e.length>0&&(0,l.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:o.length===e.length&&e.length>0,onChange:()=>{o.length===e.length?u([]):u(e.map(e=>e.id))},className:"mr-2"}),(0,l.jsx)("span",{className:"text-sm text-gray-600",children:o.length>0?"".concat(o.length,"개 선택됨"):"전체 선택"})]}),o.length>0&&(0,l.jsx)("button",{onClick:y,disabled:n,className:"py-1 px-3 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"선택 항목 삭제"})]}),e.length>0?(0,l.jsx)("div",{className:"grid grid-cols-1 gap-4",children:e.map(e=>(0,l.jsx)("div",{className:"border rounded-lg p-4 ".concat(o.includes(e.id)?"bg-purple-50 border-purple-200":""),children:h&&h.id===e.id?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"제목 *"}),(0,l.jsx)("input",{type:"text",name:"title",value:h.title,onChange:w,className:"w-full p-2 border rounded",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"비디오 URL *"}),(0,l.jsx)("input",{type:"url",name:"videoUrl",value:h.videoUrl,onChange:w,className:"w-full p-2 border rounded",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),(0,l.jsx)("textarea",{name:"description",value:h.description||"",onChange:w,className:"w-full p-2 border rounded",rows:"2"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"썸네일 URL"}),(0,l.jsx)("input",{type:"url",name:"thumbnail",value:h.thumbnail||"",onChange:w,className:"w-full p-2 border rounded"})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)("button",{onClick:k,className:"py-1 px-3 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm",children:"취소"}),(0,l.jsx)("button",{onClick:I,disabled:n,className:"py-1 px-3 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"저장"})]})]}):(0,l.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,l.jsxs)("div",{className:"flex items-center mr-4",children:[(0,l.jsx)("input",{type:"checkbox",checked:o.includes(e.id),onChange:()=>N(e.id),className:"mr-3"}),(0,l.jsx)("div",{className:"md:w-36 flex-shrink-0 mb-4 md:mb-0 md:mr-4",children:e.thumbnail?(0,l.jsx)("img",{src:e.thumbnail,alt:e.title,className:"w-full h-20 object-cover rounded"}):(0,l.jsx)("div",{className:"w-full h-20 bg-gray-200 flex items-center justify-center rounded",children:(0,l.jsx)("span",{className:"text-3xl",children:"\uD83C\uDFAC"})})})]}),(0,l.jsxs)("div",{className:"flex-grow",children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:e.title}),(0,l.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["유형: ","lesson"===e.type?"주차별 수업":"영상 자료실","lesson"===e.type&&(0,l.jsxs)(l.Fragment,{children:[" | 레벨: ",e.levelId," | 분기: ",e.quarterId," | 월: ",e.monthId," | 주차: ",e.weekId]})]})]}),(0,l.jsxs)("div",{className:"flex items-center mt-4 md:mt-0 space-x-2",children:[(0,l.jsx)("button",{onClick:()=>f(e),className:"py-1 px-3 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"편집"}),(0,l.jsx)("button",{onClick:()=>v(e.id),className:"py-1 px-3 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"삭제"})]})]})},e.id))}):(0,l.jsx)("div",{className:"text-center py-8 text-gray-500",children:n?(0,l.jsx)("p",{children:"영상을 검색 중입니다..."}):(0,l.jsx)("p",{children:i.text?i.text:"검색 결과가 없습니다. 다른 필터를 선택해보세요."})})]})}function m(){let{user:e,loading:t,isAdmin:s}=(0,n.A)(),i=(0,a.useRouter)(),[c,x]=(0,r.useState)("dashboard"),[m,p]=(0,r.useState)({text:"",type:""});(0,r.useEffect)(()=>{t||e||i.push("/login")},[e,t,i]);let j=async()=>{try{await (0,d.y4)(),i.push("/")}catch(e){console.error("로그아웃 오류:",e),p({text:"로그아웃 처리 중 오류가 발생했습니다.",type:"error"})}};return(0,l.jsx)("main",{className:"min-h-screen p-6 bg-gray-50",children:t?(0,l.jsxs)("div",{className:"flex justify-center items-center h-screen",children:[(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)("p",{className:"ml-2",children:"로딩 중..."})]}):e?(0,l.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,l.jsxs)("header",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-purple-600",children:"관리자 페이지"}),(0,l.jsx)("button",{onClick:j,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors",children:"로그아웃"})]}),(0,l.jsx)("div",{className:"mt-6 border-b border-gray-200",children:(0,l.jsxs)("nav",{className:"flex flex-wrap -mb-px",children:[(0,l.jsx)("button",{onClick:()=>x("dashboard"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("dashboard"===c?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"대시보드"}),(0,l.jsx)("button",{onClick:()=>x("add"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("add"===c?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"비디오 추가"}),(0,l.jsx)("button",{onClick:()=>x("manage"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("manage"===c?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"비디오 관리"})]})})]}),m.text&&(0,l.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat("success"===m.type?"bg-green-100 text-green-700":"error"===m.type?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:m.text}),"dashboard"===c&&(0,l.jsx)(o,{}),"add"===c&&(0,l.jsx)(u,{}),"manage"===c&&(0,l.jsx)(h,{})]}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen",children:[(0,l.jsx)("p",{className:"text-xl mb-4",children:"관리자 로그인이 필요합니다"}),(0,l.jsx)("button",{onClick:()=>i.push("/login"),className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition-colors",children:"로그인 페이지로 이동"})]})})}},650:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>i});var l=s(5155),r=s(2115),a=s(344),n=s(2743);let d=(0,r.createContext)();function i(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[c,o]=(0,r.useState)(null),[x,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{try{let e=(0,a.CA)(async e=>{if(e)try{let t=await (0,n.gL)(e.uid);i(e),o(t)}catch(t){console.error("사용자 데이터 가져오기 오류:",t),i(e),o(null)}else i(null),o(null);u(!1)});return()=>e&&e()}catch(e){return console.error("인증 상태 리스너 설정 중 오류 발생:",e),u(!1),()=>{}}},[]);let h={user:s,userData:c,loading:x,isAdmin:(null==c?void 0:c.role)==="admin",isTeacher:(null==c?void 0:c.role)==="teacher",isStudent:(null==c?void 0:c.role)==="student",hasRole:e=>!!c&&("admin"===e?"admin"===c.role:"teacher"===e?"admin"===c.role||"teacher"===c.role:"student"===e&&("admin"===c.role||"teacher"===c.role||"student"===c.role))};return(0,l.jsx)(d.Provider,{value:h,children:t})}function c(){return(0,r.useContext)(d)}},1304:(e,t,s)=>{"use strict";s.d(t,{db:()=>i,j2:()=>c});var l=s(3915),r=s(5317),a=s(858),n=s(6203);let d=0===(0,l.Dk)().length?(0,l.Wp)({apiKey:"AIzaSyARLoCaF3g_z_RcZdU7yp19rgt7YSghGWw",authDomain:"growingbeans-3aa62.firebaseapp.com",projectId:"growingbeans-3aa62",storageBucket:"growingbeans-3aa62.firebasestorage.app",messagingSenderId:"498344379382",appId:"1:498344379382:web:684c82f8f8ab7084a67dd7",measurementId:"G-NJD4T1QKKQ"}):(0,l.Dk)().length>0?(0,l.Dk)()[0]:null,i=d?(0,r.aU)(d):null;d&&(0,a.c7)(d);let c=d?(0,n.xI)(d):null},2743:(e,t,s)=>{"use strict";s.d(t,{Ln:()=>h,Nj:()=>x,a9:()=>d,gL:()=>i,h5:()=>u,nd:()=>c,xB:()=>o});var l=s(1304),r=s(5317);let a=()=>{if(!l.db)throw Error("Firestore가 초기화되지 않았습니다. 클라이언트 사이드에서만 이 함수를 호출해주세요.");return l.db},n=()=>{let e=a();return(0,r.rJ)(e,"videos")};async function d(e,t){try{let s=a(),l=(0,r.H9)(s,"users",e),n={...t,createdAt:(0,r.O5)(),updatedAt:(0,r.O5)()};return await (0,r.BN)(l,n),{uid:e,...n}}catch(e){throw console.error("사용자 데이터 생성 오류:",e),e}}async function i(e){try{let t=a(),s=(0,r.H9)(t,"users",e),l=await (0,r.x7)(s);if(l.exists())return{uid:l.id,...l.data()};return null}catch(e){throw console.error("사용자 데이터 불러오기 오류:",e),e}}async function c(e,t){try{let s=n(),l=(0,r.P)(s,(0,r._M)("levelId","==",e),(0,r._M)("quarterId","==",t),(0,r._M)("type","==","library")),a=await (0,r.GG)(l),d=[];return a.forEach(e=>{d.push({id:e.id,...e.data()})}),d.sort((e,t)=>e.title.localeCompare(t.title,"ko"))}catch(e){throw console.error("분기별 영상 불러오기 오류:",e),e}}async function o(e,t,s,l){try{let a=n(),d=(0,r.P)(a,(0,r._M)("levelId","==",e),(0,r._M)("quarterId","==",t),(0,r._M)("monthId","==",s),(0,r._M)("weekId","==",l),(0,r._M)("type","==","lesson")),i=await (0,r.GG)(d),c=[];return i.forEach(e=>{c.push({id:e.id,...e.data()})}),c.sort((e,t)=>e.title.localeCompare(t.title,"ko"))}catch(e){throw console.error("주차별 영상 불러오기 오류:",e),e}}async function x(e){try{let t=n(),s={...e,createdAt:(0,r.O5)(),updatedAt:(0,r.O5)()};return{id:(await (0,r.gS)(t,s)).id,...s}}catch(e){throw console.error("비디오 추가 오류:",e),e}}async function u(e,t){try{let s=a(),l=(0,r.H9)(s,"videos",e);return await (0,r.mZ)(l,{...t,updatedAt:(0,r.O5)()}),{id:e,...t}}catch(e){throw console.error("비디오 업데이트 오류:",e),e}}async function h(e){try{let t=a(),s=(0,r.H9)(t,"videos",e);return await (0,r.kd)(s),{success:!0,id:e}}catch(e){throw console.error("비디오 삭제 오류:",e),e}}},2949:(e,t,s)=>{Promise.resolve().then(s.bind(s,639))},5695:(e,t,s)=>{"use strict";var l=s(8999);s.o(l,"useParams")&&s.d(t,{useParams:function(){return l.useParams}}),s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[992,118,288,441,684,358],()=>t(2949)),_N_E=e.O()}]);